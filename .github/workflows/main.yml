name: CI-CD

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - name: Docker hub login
        uses: docker/login-action@v3.3.0
        with:
          username: ${{secrets.DOCKER_HUB_USERNAME}}
          password: ${{secrets.DOCKER_HUB_PWD}}
      - name: Print current path
        run: ls ..
      - name: Build e push da imagem docker
        uses: docker/build-push-action@v6.15.0
        with:
          context: .
          push: true
          tags:
            caiovrodrigues/fake-shop:latest
  cd:
    runs-on: ubuntu-latest
    steps:
      - name: Autentica na aws
        run: echo "Etapa de autenticação na aws - aws configure"
      - name: Conectamos no cluster
        run: echo "Etapa de conexão com o cluster - aws eks update-kubeconfig --name clusterName"
      - name: Deploy dos manifestos no cluster
        run: echo "Etapa de deploy dos manifestos no cluster"
      - run: echo "Fim do jbo de Entrega contínua"
      
      
      
